<head>
  <title>PeerJS ドキュメント</title>
  <meta charset="UTF-8" />
  <meta property="og:locale" content="ja_JP" />  
  <meta name="viewport" content="width=device-width, maximum-scale=1">
  <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
  <link href="./style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" src="./index.js"></script>
</head>

<body>
  <section class="start">
    <h1><a href="/skyway/">PeerJS</a> <span class="title">docs</span><span class="title">SkyWay対応版</span></h1>
    <p><br>PeerJSは、WebRTCを利用したピア·ツー·ピアのデータ、ビデオ、オーディオ通信を簡単に実現することができます。このドキュメントでは、PeerJS APIの基本的な使い方を紹介します。PeerJSを用いた実装例をご覧になりたい方は, <a href="https://github.com/nttcom/peerjs/tree/master/examples">サンプル</a> ページを御覧ください。</P>
      <p>このドキュメントは、NTTコミュニケーションズが提供する<a href="http://nttcom.github.io/skyway/">クラウドサービス「SkyWay」</a>にて利用できるようにカスタマイズした<a href="https://github.com/nttcom/peerjs">PeerJS</a>を対象としています。</p>
      <h2>セットアップ</h2>
      <h3>1. PeerJSのクライアントライブラリをインクルード</h3>
      <p>PeerJSクライアントライブラリをあなたのアプリケーションにインクルードしてください。</p>
      <pre>&lt;script src="https://skyway.io/dist/0.3/peer.js"&gt;&lt;/script&gt;</pre>
      <p>PeerJSライブラリ（<a download href="https://skyway.io/dist/0.3/peer.js">peer.js</a>, <a download href="https://skyway.io/dist/0.3/peer.min.js">peer.min.js</a>）はあなたのサーバ上に設置することができます。
      ソースコードは<a href="https://github.com/nttcom/peerjs">Githubからfork</a>する事ができます。</p>
      <h3>2. Peerオブジェクトを作成</h3>
      <p>Peerオブジェクトは、Peerコネクションを生成、受信する為に利用します。</p>
      <pre>var peer = new Peer({key: 'APIKEY'});</pre>
      <p>Peerのコンストラクタに渡す'APIKEY'は、SkyWayのAPIキーです。<a
      href="http://nttcom.github.io/skyway/registration.html">APIキーの申し込み</a>を行うことで無料で取得することができます。APIキー申込時には利用ドメインを申請していただきます。APIキーは申請したドメインからのみ利用可能です。</p>

      <p>PeerJSのセッション情報交換やシグナリングに利用するサーバを、自身で構築することもできます。
          詳しくは<a href="http://github.com/peers/peerjs-server">peerjs-server</a>をご覧ください。</p>
      <p>これで利用するための準備はすべて整いました！</p>

      <h2>使い方</h2>
      <p>Peerオブジェクトは生成時、ランダムなID（以下、PeerID）が付与されます。</p>
      <pre>peer.on('open', function(id) {
  console.log('My peer ID is: ' + id);
});</pre>
      <p>他のPeerと接続したい場合は、接続先のPeerIDが必要になります。
      RestAPIを利用して接続先のPeerIDを入手するか、何らかの仕組みでPeerIDを交換してください。<a href="#peer"><code>Peer</code> constructor</a>のオプションに自身のPeerIDを指定すると、この処理を省略することができます。</p>

      <p>その他の<a href="#peer-options">オプション</a>、メソッド、<a href="#peeron">イベント</a>、<a href="#peeron-error">エラー処理</a>などの詳細は、<a href="#peer">Peer API リファレンス</a>をお読みください。</p>

      <h3>Data connections</h3>
      <p>相手のPeerIDを指定して<code>peer.connect</code>を実行するとData connectionを開始します。相手から接続要求はいつでも<code>connection</code> イベントを利用して受け取ることができます。 </p>
      <div class="two-col">
        <div class="col col-header">接続開始</div>
        <div class="col col-header">接続イベントの受信</div>
        <div class="col"><pre>var conn = peer.connect('dest-peer-id');</pre></div>
        <div class="col"><pre>peer.on('connection', function(conn) { ... });</pre></div>
        <div class="clear"></div>
      </div>
      <p><code>peer.connect</code>と<code>connection</code>イベントのコールバックでは<code>DataConnection</code>オブジェクトを提供します。このオブジェクトを使用してデータの送受信を行うことができます。</p>
      <pre>conn.on('open', function() {
  // メッセージを受信
  conn.on('data', function(data) {
    console.log('Received', data);
  });

  // メッセージを送信
  conn.send('Hello!');
});</pre>
      <p>メソッドとイベントの詳細は、<a href="#dataconnection">DataConnection API リファレンス</a>をご覧ください。</p>
      <h3>Video/audio calls</h3>
      <p>相手のPeerIDを指定して<code>peer.call</code>を実行することで、その相手を呼び出すことができます。相手があなたを呼び出した場合、 <code>call</code>イベントが発生します。
      <p><code>call</code>イベントを受信した時は、必ずそのイベントに応答する必要があります。応答しなければ接続は確立しません。</p>
      <div class="two-col">
        <div class="col col-header">呼び出し開始</div>
        <div class="col col-header">呼び出しへの応答</div>
        <div class="col"><pre>// Call a peer, providing our mediaStream
var call = peer.call('dest-peer-id',
  mediaStream);

</pre></div>
        <div class="col"><pre>peer.on('call', function(call) {
  // Answer the call, providing our mediaStream
  call.answer(mediaStream);
});</pre></div>
        <div class="clear"></div>
      </div>
      <p>相手を呼び出す時、または、呼び出しに応答する時には、MediaStreamを提供する必要があります。
      MediaStreamにはビデオストリーム（ウェブカメラの映像）やオーディオストリームなどがあり、<a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator.getUserMedia"><code>navigator.getUserMedia</code></a>によって取得することができます。取得できる内容はブラウザによってことなります。
      尚、呼び出しに応答する時のMediaStreamは必須ではありません。もし応答時にMediaStreamをセットしなければ、一方向の通話が確立されます。
      通話が確立されると、<code>open</code>プロパティにtrueがセットされます。
      <p><code>peer.call</code> と <code>call</code> イベントのコールバックではMediaConnectionオブジェクトを提供します。
      MediaConnectionオブジェクトは<code>stream</code> イベントをキャッチすることができます。<code>stream</code>イベントのコールバックには相手の映像／音声ストリームが含まれます。</p>
      <pre>call.on('stream', function(stream) {
  // `stream` is the MediaStream of the remote peer.
  // Here you'd add it to an HTML video/canvas element.
});</pre>
      <p>詳しくは <a href="#mediaconnection">MediaConnection API reference</a> をご覧ください。</p>

      <h2>SkyWay RestAPIの使い方</h2>
      <h3>/active/list/<APIKEY></h3>
      <p>APIキー毎のアクティブなPeerIDを取得します。<p>
      <pre>
  Request : https://skyway.io/active/list/APIKEY
  Response : [peerid1,peerid2,peerid3,peerid4,.....]</pre>
      <h3>/active/count/<APIKEY></h3>
      <p>APIキー毎のアクティブなPeerIDの数を取得します。<p>
      <pre>
  Request : https://skyway.io/active/count/APIKEY
  Response : {"name":"active_session","count":0,"api_key":"APIKEY"}</pre>

      <p>SkyWay WebAPIはAPIキー申請時に申請していただいたドメインからのみアクセスが可能です。</p>

      <h2>FAQ</h2>

        <h3>どのような種類のデータを送ることができますか？</h3>

        <p>PeerJSは <a href="https://github.com/binaryjs/js-binarypack">BinaryPack</a>シリアライゼーションフォーマットを利用しています。JSONやバイナリBlobs、ArrayBuffersなど様々なデータを簡単な手順で送受信することができます。</p>
          <pre>
conn.send({
  strings: 'hi!',
  numbers: 150,
  arrays: [1,2,3],
  evenBinary: new Blob([1,2,3]),
  andMore: {bool: true}
});</pre>

        <h3>PeerJSを利用することができないシーンはありますか？</h3>

          <p>シンメトリックNATの内側にいるクライアント同士はNATを超えることができないため、通信することができません。
              ただし、TURNサーバを利用して接続を中継すれば回避することができます。TURNサーバは提供していないため必要であれば別途用意してください。
              TURNサーバの情報は、<code>Peer</code>オブジェクトのオプションで指定することができます。</p>
        <h3>TURNサーバはどのようにして利用するのでしょうか？</h3>
        <p>Peerオブジェクトを生成する際、オプションのiceServersにURL等の情報を設定してください。</p>
<pre>
var peer = new Peer({
  config: {'iceServers': [
    { url: 'stun:stun.skyway.io:3478' },
    { url: 'turn:homeo@turn.bistri.com:80', credential: 'homeo' }
  ]} /* Sample servers, please use appropriate ones */
});
</pre>
        <h3>現在のブラウザ対応状況は?</h3>

        　<p>WebRTC仕様との互換性並びにブラウザの対応状況は<a href="http://peerjs.com/status">こちら</a>をご覧ください。尚、SkyWay対応版のPeerJSについては、動作に差異がある可能性があります。</p>

        <h3>接続しようとしてるピアに接続できない場合はどうなりますか？</h3>

          <p>ピアに接続できない場合はPeerServerにて接続要求を5秒間保持します。ピアが一時的に再接続するような場合、コネクションを切らずに保持することができます。尚、SkyWayは現時点ではこの機能に対応していません。</p>

        <h3>ピアとつながらない場合は何を確認するべきでしょうか？</h3>
          <p>ピア同士がシンメトリックNATの内側にいる可能性があります。この場合はTURNサーバを利用してください。</p>
          <p>ファイアウォール等でUDPのポート3478（STUNサーバへの問い合わせに必要）をブロックしているかもしれません。STUNサーバへの問い合わせが可能な状況でご利用ください。</p>

        <h3>遅延／帯域幅は?</h3>
          <p>ピア同士のデータのやり取りはサーバを経由しないため、それが原因となる遅延などは発生しません。ピア同士の処理性能やネットワーク環境に依存します。</p>
          <p>ピア同士のコネクション確立に関する遅延は、セッション情報の中継（以下、シグナリング）とユーザの識別という2つに分類できます。PeerJSでは、シグナリングの時間を短縮するために、XHRストリーミングリクエストでデータを送った後、WebSocketで送ります。ユーザの識別に関しては手動でIDを指定することで、サーバ側にてIDを生成する際のRTT（Round-Trip delay Time）を短縮することができます。尚、SkyWayに関してはXHRでの接続に現時点では対応していません。</p>
        <h3>その他</h3>
          <p><a href="https://groups.google.com/forum/?fromgroups#!forum/peerjs">PeerJS Google Group(英語のみ)</a></p>
      <h3>免責事項</h3>
      <p>本ドキュメントは<a href="http://peerjs.com/docs/">http://peerjs.com/docs/</a>を元に、NTTコミュニケーションズが提供するSkyWayを利用するための情報等を追記し公開しています。ドキュメント原本に関する個別問い合わせには応じることができませんので、予めご了承ください。</p>

  </section>

  <header class="left">
    <h2>API Reference<a class="hide icon">&laquo;</a><a class="show icon">&raquo;</a></h2>
  </header>
  <header class="right">
    <h2>Getting Started</h2>
  </header>

  <section class="api">
    <div class="toplevel " id="peer"><span class="name"><a href="#peer">Peer</a><span class="tag type constructor">constructor</span><span class="snippet">var peer = new Peer([id], [options]);</span></span><p class="description">他のpeerへ接続できるpeerです。また、他のpeerからのコネクションをlistenできます。</p><div class="children"><div class="child " id="peer-id"><span class="name"><a href="#peer-id"><span class="optional"><span class="bracket">[</span>id<span class="bracket">]</span></span></a><span class="tag type string">string</span></span><p class="description">他のピアがこのピアへ接続するときに使われるIDです。もしIDが指定されない場合、ブローカサーバがIDを生成します。<span class='warn'>このIDを利用してピアを特定するのは推奨しません。なぜならば、このIDはコネクションをブローカ(仲介)するのにのみ使われるように作成されているためです。特定に他の情報を使う場合は、<a href='#peerconnect-options'><code>metadata</code></a>の利用を推奨します。</span></p></div><div class="child " id="peer-options"><span class="name"><a href="#peer-options"><span class="optional"><span class="bracket">[</span>options<span class="bracket">]</span></span></a><span class="tag type object">object</span></span><div class="children"><div class="child " id="peer-options-key"><span class="name"><a href="#peer-options-key">key</a><span class="tag type string">string</span></span><p class="description">クラウド上のPeerServerを利用するためのAPIキーです。</p></div><div class="child " id="peer-options-host"><span class="name"><a href="#peer-options-host">host</a><span class="tag type string">string</span></span><p class="description">サーバのホスト名です。デフォルトは、<code>skyway.io</code>です。相対ホスト名として、'/' も許容します。</p></div><div class="child " id="peer-options-port"><span class="name"><a href="#peer-options-port">port</a><span class="tag type number">number</span></span><p class="description">サーバのポート番号です。デフォルトはホストがskyway.ioの場合は<code>443</code>番で、その他の場合は<code>80</code>番です。</p></div><div class="child " id="peer-options-path"><span class="name"><a href="#peer-options-path">path</a><span class="tag type string">string</span></span><p class="description">自身のPeerServerが動作している場所のpathです。デフォルトは、<code>'/'</code>です。</p></div><div class="child beta_030 " id="peer-options-secure"><span class="name"><a href="#peer-options-secure">secure</a><span class="tag type boolean">boolean</span><span class="tag beta_030">beta (0.3.0)</span></span><p class="description">skyway.ioを利用する場合は、デフォルトは <code>true</code> であり、<code>true</code>が必須です。</p></div><div class="child " id="peer-options-config"><span class="name"><a href="#peer-options-config">config</a><span class="tag type object">object</span></span><p class="description">RTCPeerConnectionへ渡される設定項目のハッシュです。このハッシュは、カスタマイズされたICE/TURNサーバを含みます。デフォルト値は、<code>{ 'iceServers': [{ 'url': 'stun:stun.skyway.io:3478' }] }</code>です。</p></div><div class="child beta_030 " id="peer-options-debug"><span class="name"><a href="#peer-options-debug">debug</a><span class="tag type number">number</span><span class="tag beta_030">beta (0.3.0)</span></span><p class="description">debugレベルにしたがってログを出力します。デフォルト値は<code>0</code>です。</p><div class="children"><div class="child " id="peer-options-debug-0"><span class="name"><a href="#peer-options-debug-0">0</a></span><p class="description">ログを出力しません。</p></div><div class="child " id="peer-options-debug-1"><span class="name"><a href="#peer-options-debug-1">1</a></span><p class="description">エラーのみログ出力します。</p></div><div class="child " id="peer-options-debug-2"><span class="name"><a href="#peer-options-debug-2">2</a></span><p class="description">エラーと警告をログ出力します。</p></div><div class="child " id="peer-options-debug-3"><span class="name"><a href="#peer-options-debug-3">3</a></span><p class="description">すべてのログを出力します。</p></div></div></div></div></div></div></div><div class="toplevel " id="peerconnect"><span class="name"><a href="#peerconnect">peer.connect</a><span class="tag type method">method</span><span class="snippet">var <a href='#dataconnection'>dataConnection</a> = peer.connect(id, [options]);</span></span><p class="description"><code>id</code>で指定されたリモートのPeerへ接続し、data connectionを返します。コネクションに失敗した場合に備え、<a href='#peeron-error'><code>error</code></a>イベントを設定してください。</p><div class="children"><div class="child " id="peerconnect-id"><span class="name"><a href="#peerconnect-id">id</a><span class="tag type string">string</span></span><p class="description">リモートpeerのブローカーIDです(リモートpeerの<a href='#peerid'><code>peer.id</code></a>です)。</p></div><div class="child " id="peerconnect-options"><span class="name"><a href="#peerconnect-options"><span class="optional"><span class="bracket">[</span>options<span class="bracket">]</span></span></a><span class="tag type object">object</span></span><div class="children"><div class="child " id="peerconnect-options-label"><span class="name"><a href="#peerconnect-options-label">label</a><span class="tag type string">string</span></span><p class="description">data connectionを識別するためのユニークなラベルです。もし特定されていない場合は、ランダムに生成されます。<a href='#dataconnection-label'><code>dataConnection.label</code></a>を通じてアクセスできます。</p></div><div class="child " id="peerconnect-options-metadata"><span class="name"><a href="#peerconnect-options-metadata">metadata</a></span><p class="description">コネクションに関連付けされるメタデータで、コネクションを開始したpeerに渡されます。<a href='#dataconnection-metadata'><code>dataConnection.metadata</code></a>を通じてアクセスできます。serialize可能です。</p></div><div class="child " id="peerconnect-options-serialization"><span class="name"><a href="#peerconnect-options-serialization">serialization</a><span class="tag type string">string</span></span><p class="description"><code>binary</code> (default), <code>binary-utf8</code>, <code>json</code>, or <code>none</code> を指定可能です。<a href='#dataconnection-serialization'><code>dataConnection.serialization</code></a>を通じてアクセスできます。<span class='tip'><code>binary-utf8</code>はパフォーマンスの低下を引き起こすことがあります。UTF8文字列がbinaryフォーマットにパックされるためです。</span></p></div><div class="child " id="peerconnect-options-reliable"><span class="name"><a href="#peerconnect-options-reliable">reliable</a><span class="tag type boolean">boolean</span></span><p class="description">data channelに信頼性をもたせるか(例えば、大きなファイルの転送）、もたせないか（例えば、ゲームやストリーミング）を指定可能です。デフォルトはfalseです。true設定は互換性のないブラウザ（Chrome 30とそれ以下)のために、shimを使います。そのため、完全なパフォーマンスを提供できないことがあります。</p></div></div></div></div></div><div class="toplevel beta_030 " id="peercall"><span class="name"><a href="#peercall">peer.call</a><span class="tag type method">method</span><span class="tag beta_030">beta (0.3.0)</span><span class="snippet">var <a href='#mediaconnection'>mediaConnection</a> = peer.call(id, stream);</span></span><p class="description">idで指定されたリモートのpeerへ発信し、media connectionを返します。コネクションに失敗した場合に備え、<a href='#peeron-error'><code>error</code></a>イベントを設定してください。</p><div class="children"><div class="child " id="peercall-id"><span class="name"><a href="#peercall-id">id</a><span class="tag type string">string</span></span><p class="description">リモートpeerのブローカーID(リモートpeerの<a href='#peerid'><code>peer.id</code></a>)です。</p></div><div class="child " id="peercall-stream"><span class="name"><a href="#peercall-stream">stream</a><span class="tag type MediaStream">MediaStream</span></span><p class="description">何らかのストリームです。</p></div></div></div><div class="toplevel " id="peeron"><span class="name"><a href="#peeron">peer.on</a><span class="tag type method">method</span><span class="snippet">peer.on(event, callback);</span></span><p class="description">peerイベントのリスナを設定します。</p><div class="children"><div class="child " id="peeron-open"><span class="name"><a href="#peeron-open">'open'</a><span class="tag type event">event</span><span class="snippet">peer.on('open', function(id) { ... });</span></span><p class="description">PeerServerへの接続が確立すると発生します。このイベントが発生する前にpeerを利用することもできますが、サーバへのメッセージはキューイングされます。<code>id</code>はブローカーIDです（コンストラクタで指定されるか、サーバによって割付けされます）。<span class='tip'>コネクションの速度が重要である場合、他のピアへ接続する前に、このイベントを待つべきではありません。</span> </p></div><div class="child " id="peeron-connection"><span class="name"><a href="#peeron-connection">'connection'</a><span class="tag type event">event</span><span class="snippet">peer.on('connection', function(<a href='#dataconnection'>dataConnection</a>) { ... });</span></span><p class="description">リモートピアと新しいdata connectionが確立すると発生します。</p></div><div class="child beta_030 " id="peeron-call"><span class="name"><a href="#peeron-call">'call'</a><span class="tag type event">event</span><span class="tag beta_030">beta (0.3.0)</span><span class="snippet">peer.on('call', function(<a href='#mediaconnection'>mediaConnection</a>) { ... });</span></span><p class="description">リモートのpeerがあなたに発信してきたときに発生します。<code>mediaConnection</code>はこの時点でアクティブではありません。つまり、最初に応答する必要があります（<a href='#mediaconnection-answer'><code>mediaConnection.answer([stream]);</code></a>）。その後、streamイベントをlistenできます。</p></div><div class="child " id="peeron-close"><span class="name"><a href="#peeron-close">'close'</a><span class="tag type event">event</span><span class="snippet">peer.on('close', function() { ... });</span></span><p class="description">ピアとの接続が<a href='#peerdestroy'>destroyed</a>となった場合に発生します。<span class='tip'>peerを確実にクリアするためには、peerが不要となった時点で、peer.destroy()の実行を推奨します。</span></p></div><div class="child " id="peeron-error"><span class="name"><a href="#peeron-error">'error'</a><span class="tag type event">event</span><span class="snippet">peer.on('error', function(err) { ... });</span></span><p class="description">peerに対するエラーは、ほとんど常に致命的であり、peerを破壊します。ソケットから生じるエラーや、PeerConnectionsから生じるエラーは、このイベントに伝えられます。</p><div class="children"><div class="child fatal " id="peeron-error-browser-incompatible"><span class="name"><a href="#peeron-error-browser-incompatible">'browser-incompatible'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">利用しようとしているwebRTC機能のすべて、またはいくつかについて、クライアントのブラウザがサポートしていません。</p></div><div class="child fatal " id="peeron-error-invalid-id"><span class="name"><a href="#peeron-error-invalid-id">'invalid-id'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">Peerコンストラクタへ渡されたIDに、不正な文字が含まれています。</p></div><div class="child fatal " id="peeron-error-invalid-key"><span class="name"><a href="#peeron-error-invalid-key">'invalid-key'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">Peerコンストラクタへ渡されたAPI Keyが不正な文字列を含んでいます。または、API Keyが含まれていません（クラウド上のサーバを利用する場合のみ）。</p></div><div class="child fatal " id="peeron-error-unavailable-id"><span class="name"><a href="#peeron-error-unavailable-id">'unavailable-id'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">Peerコンストラクタへ渡されたIDは既に利用されています。</p></div><div class="child fatal " id="peeron-error-ssl-unavailable"><span class="name"><a href="#peeron-error-ssl-unavailable">'ssl-unavailable'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">PeerJSはsecureな状態を利用しますが、クラウド上のサーバはSSLをサポートしていません。独自のPeerServerを利用してください。</p></div><div class="child " id="peeron-error-server-disconnected"><span class="name"><a href="#peeron-error-server-disconnected">'server-disconnected'</a><span class="tag type Error">Error</span></span><p class="description">既にこのPeerとの接続が切断されており、新しいコネクションを作成できません。</p></div><div class="child fatal " id="peeron-error-server-error"><span class="name"><a href="#peeron-error-server-error">'server-error'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">サーバに到達できません。</p></div><div class="child fatal " id="peeron-error-socket-error"><span class="name"><a href="#peeron-error-socket-error">'socket-error'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">ソケットからのエラーです。</p></div><div class="child fatal " id="peeron-error-socket-closed"><span class="name"><a href="#peeron-error-socket-closed">'socket-closed'</a><span class="tag type Error">Error</span><span class="tag fatal">fatal</span></span><p class="description">ソケットが予期せずクローズしました。</p></div></div></div></div></div><div class="toplevel " id="peerdisconnect"><span class="name"><a href="#peerdisconnect">peer.disconnect</a><span class="tag type method">method</span><span class="snippet">peer.disconnect();</span></span><p class="description">サーバとの接続をクローズします。既存のデータおよびメディア接続はそのままです。<a href='#peerdestroyed'><code>peer.destroyed</code></a>に<code>true</code>が設定されます。<span class='warn'>この操作は必ず実施してください。それぞれのPeerオブジェクトが利用不可能、またはコネクションを受信できません。idも（クラウド上の）サーバに没収されます。</span></p></div><div class="toplevel " id="peerdestroy"><span class="name"><a href="#peerdestroy">peer.destroy</a><span class="tag type method">method</span><span class="snippet">peer.destroy();</span></span><p class="description">サーバへの接続をクローズし、すべての既存のコネクションを終了します。<a href='#peerdestroyed'><code>peer.destroyed</code></a>は<code>true</code>に設定されます。<span class='warn'>この操作は必ず実施してください。それぞれのPeerオブジェクトが利用不可能、またはコネクションを受信できません。idも（クラウド上の）サーバに没収されます。さらに、データコネクション・メディアコネクションもクローズされます。</span></p></div><div class="toplevel " id="peerid"><span class="name"><a href="#peerid">peer.id</a><span class="tag type string">string</span></span><p class="description">peerのブローカーIDです。もしIDが<a href='#peer'>constructor</a>で指定されない場合、<a href='#peeron-open'><code>open</code></a>が発生するまで、<code>undefined</code>のままです。</p></div><div class="toplevel " id="peerconnections"><span class="name"><a href="#peerconnections">peer.connections</a><span class="tag type object">object</span></span><p class="description">リモートpeerのIDがkeyとして、peerと関連付けされるコネクションを持つハッシュです。<span class='tip'>このハッシュに頼るよりも、自身でコネクションを追跡管理することを推奨します。</span></p></div><div class="toplevel " id="peerdisconnected"><span class="name"><a href="#peerdisconnected">peer.disconnected</a><span class="tag type boolean">boolean</span></span><p class="description">PeerServerとのアクティブなコネクションがある場合は、<code>false</code> です。</p></div><div class="toplevel " id="peerdestroyed"><span class="name"><a href="#peerdestroyed">peer.destroyed</a><span class="tag type boolean">boolean</span></span><p class="description">このpeerにおける、全接続が利用されていない場合は<code>true</code>です。</p></div><div class="toplevel " id="dataconnection"><span class="name"><a href="#dataconnection">DataConnection</a><span class="tag type class">class</span></span><p class="description">WebRTCのData Channelをラップします。このオブジェクトを得るためには、<a href='#peerconnect'><code>peer.connect</code></a>を使うか、<a href='#peeron-connect'><code>connect</code></a>イベントをlistenしてください</p><div class="children"><div class="child " id="dataconnection-send"><span class="name"><a href="#dataconnection-send">.send</a><span class="tag type method">method</span><span class="snippet">dataConnection.send(data);</span></span><p class="description">デフォルトで、<code>data</code> はBinaryPackでシリアライズされて、リモートのピアで送信されます。</p><div class="children"><div class="child " id="dataconnection-send-data"><span class="name"><a href="#dataconnection-send-data">data</a></span><p class="description">オブジェクト、strings、blobsなどのどんなデータ形式でも送信可能です。</p></div></div></div><div class="child " id="dataconnection-close"><span class="name"><a href="#dataconnection-close">.close</a><span class="tag type method">method</span><span class="snippet">dataConnection.close();</span></span><p class="description">DataChannelとPeerConnectionを解放して、コネクションをクローズします。</p></div><div class="child " id="dataconnection-on"><span class="name"><a href="#dataconnection-on">.on</a><span class="tag type method">method</span><span class="snippet">dataConnection.on(event, callback);</span></span><p class="description">data connectionイベントのリスナを設定します。</p><div class="children"><div class="child " id="dataconnection-on-data"><span class="name"><a href="#dataconnection-on-data">'data'</a><span class="tag type event">event</span><span class="snippet">dataConnection.on('data', function(data) { ... });</span></span><p class="description">リモートpeerからデータを受信した場合に発生します。</p></div><div class="child " id="dataconnection-on-open"><span class="name"><a href="#dataconnection-on-open">'open'</a><span class="tag type event">event</span><span class="snippet">dataConnection.on('open', function() { ... });</span></span><p class="description">コネクションが利用可能となった場合に発生します。</p></div><div class="child " id="dataconnection-on-close"><span class="name"><a href="#dataconnection-on-close">'close'</a><span class="tag type event">event</span><span class="snippet">dataConnection.on('close', function() { ... });</span></span><p class="description">あなたが、またはリモートのpeerがdata connectionをクローズした場合に発生します。<span class='warn'>Firefoxはこのイベントをまだサポートしていません。</span></p></div><div class="child " id="dataconnection-on-error"><span class="name"><a href="#dataconnection-on-error">'error'</a><span class="tag type event">event</span><span class="snippet">dataConnection.on('error', function(err) { ... });</span></span></div></div></div><div class="child " id="dataconnection-buffersize"><span class="name"><a href="#dataconnection-buffersize">.bufferSize</a><span class="tag type number">number</span></span><p class="description">ブラウザのバッファが一杯になった場合に、キューされるメッセージのサイズです。</p></div><div class="child " id="dataconnection-datachannel"><span class="name"><a href="#dataconnection-datachannel">.dataChannel</a><span class="tag type object">object</span></span><p class="description">コネクションに関連付けされたRTCDataChannelオブジェクトへの参照です。</p></div><div class="child " id="dataconnection-label"><span class="name"><a href="#dataconnection-label">.label</a><span class="tag type string">string</span></span><p class="description">コネクションが開始されたときにPeerJSからアサインされる、または指定されるオプションのラベルです。</p></div><div class="child " id="dataconnection-metadata"><span class="name"><a href="#dataconnection-metadata">.metadata</a></span><p class="description">コネクションが開始されたときに、コネクションと関連付けされるメタデータです。</p></div><div class="child " id="dataconnection-open"><span class="name"><a href="#dataconnection-open">.open</a><span class="tag type boolean">boolean</span></span><p class="description">コネクションがopenであり、読み込み/書き込みの準備ができている場合にtrueになります。</p></div><div class="child " id="dataconnection-peerconnection"><span class="name"><a href="#dataconnection-peerconnection">.peerConnection</a><span class="tag type object">object</span></span><p class="description">コネクションに関連付けされる、RTCPeerConnectionへの参照です。</p></div><div class="child " id="dataconnection-peer"><span class="name"><a href="#dataconnection-peer">.peer</a><span class="tag type string">string</span></span><p class="description">コネクションの相手側のpeer IDです。</p></div><div class="child " id="dataconnection-reliable"><span class="name"><a href="#dataconnection-reliable">.reliable</a><span class="tag type boolean">boolean</span></span><p class="description">信頼性のあるdata channelの場合にtrueです。コネクションの開始時に定義されます。</p></div><div class="child " id="dataconnection-serialization"><span class="name"><a href="#dataconnection-serialization">.serialization</a><span class="tag type string">string</span></span><p class="description">コネクションを通じて送信されるデータのserializeフォーマットです。<code>binary</code> (デフォルト値)、 <code>binary-utf8</code>、 <code>json</code>、 または <code>none</code> となります。</p></div><div class="child " id="dataconnection-type"><span class="name"><a href="#dataconnection-type">.type</a><span class="tag type string">string</span></span><p class="description">data connectionでは、常に<code>'data'</code>が設定されます。</p></div></div></div><div class="toplevel beta_030 " id="mediaconnection"><span class="name"><a href="#mediaconnection">MediaConnection</a><span class="tag type class">class</span><span class="tag beta_030">beta (0.3.0)</span></span><p class="description">WebRTCのmedia streamをラップします。このオブジェクトを得るためには、<a href='#peercall'><code>peer.call</code></a>を使うか、<a href='#peeron-call'><code>call</code></a>イベントをlistenしてください。</p><div class="children"><div class="child " id="mediaconnection-answer"><span class="name"><a href="#mediaconnection-answer">.answer</a><span class="tag type method">method</span><span class="snippet">mediaConnection.answer([stream]);</span></span><p class="description"><a href='#peeron-call'><code>call</code></a>イベントを受信した場合に、応答するためにコールバックにて与えられるmedia connectionにて<code>.answer</code>を呼び出せます。また、オプションで自身のmedia streamを設定できます。</p><div class="children"><div class="child " id="mediaconnection-answer-stream"><span class="name"><a href="#mediaconnection-answer-stream"><span class="optional"><span class="bracket">[</span>stream<span class="bracket">]</span></span></a><span class="tag type MediaStream">MediaStream</span></span><p class="description"><a href='https://developer.mozilla.org/en-US/docs/Web/API/Navigator.getUserMedia'><code>getUserMedia</code></a>から取得できるWebRTCのmedia streamです。</p></div></div></div><div class="child " id="mediaconnection-close"><span class="name"><a href="#mediaconnection-close">.close</a><span class="tag type method">method</span><span class="snippet">mediaConnection.close();</span></span><p class="description">media connectionをクローズします。</p></div><div class="child " id="mediaconnection-on"><span class="name"><a href="#mediaconnection-on">.on</a><span class="tag type method">method</span><span class="snippet">mediaConnection.on(event, callback);</span></span><p class="description">media connectionイベントのリスナを設定します。</p><div class="children"><div class="child " id="mediaconnection-on-stream"><span class="name"><a href="#mediaconnection-on-stream">'stream'</a><span class="tag type event">event</span><span class="snippet">mediaConnection.on('stream', function(stream) { ... });</span></span><p class="description">リモートのpeerが<code>stream</code>を追加したときに発生します。</p></div><div class="child " id="mediaconnection-on-close"><span class="name"><a href="#mediaconnection-on-close">'close'</a><span class="tag type event">event</span><span class="snippet">mediaConnection.on('close', function() { ... });</span></span><p class="description">あなたかリモートのpeerがmedia connectionをクローズしたおきに発生します。<span class='warn'>Firefoxはこのイベントをまだサポートしていません。</span></p></div><div class="child " id="mediaconnection-on-error"><span class="name"><a href="#mediaconnection-on-error">'error'</a><span class="tag type event">event</span><span class="snippet">mediaConnection.on('error', function(err) { ... });</span></span></div></div></div><div class="child " id="mediaconnection-open"><span class="name"><a href="#mediaconnection-open">.open</a><span class="tag type boolean">boolean</span></span><p class="description">media connectionがアクティブなとき（例えば、呼び出しにたいして、応答があった後）に、trueとなります。もし片方向通話のために、最大待ち時間を設定したい場合に、これをチェックできます。</p></div><div class="child " id="mediaconnection-metadata"><span class="name"><a href="#mediaconnection-metadata">.metadata</a></span><p class="description">コネクションが開始されたときに、コネクションと関連付けされるメタデータです。</p></div><div class="child " id="mediaconnection-peer"><span class="name"><a href="#mediaconnection-peer">.peer</a><span class="tag type string">string</span></span><p class="description">コネクションの相手側のpeer IDです。</p></div><div class="child " id="mediaconnection-type"><span class="name"><a href="#mediaconnection-type">.type</a><span class="tag type string">string</span></span><p class="description">media connectionでは、常に<code>'media'</code>が設定されます。</p></div></div></div><div class="toplevel utility " id="util"><span class="name"><a href="#util">util</a><span class="tag type object">object</span><span class="tag utility">utility</span></span><p class="description">多数の有用なユーティリティを提供します。<span class='warn'>ここで記載されているutlitiesのみ<code>util</code>で保証されます。ここに記載されないutilitiesは予告なく除去されることがあります。これらを、私達は'大きな変更'とは考えません。</span></p><div class="children"><div class="child " id="util-browser"><span class="name"><a href="#util-browser">.browser</a><span class="tag type string">string</span><span class="snippet">if (util.browser === 'Firefox') { /* OK to peer with Firefox peers. */ }</span></span><p class="description">利用中のブラウザを返します。このプロパティは、2つのピアの接続可否を決定する際に有用です。例えば、data connectionsはメジャーなブラウザ間では、まだ相互接続が現時点ではできません。<code>util.browser</code>は現在、'Firefox'、'Chrome'、'Unsupported'、'Supported'(WebRTC互換している不明なブラウザ)の値を持ちます。</p></div><div class="child " id="util-supports"><span class="name"><a href="#util-supports">.supports</a><span class="tag type object">object</span><span class="snippet">if (util.supports.data) { /* OK to start a data connection. */ }</span></span><p class="description">利用中のブラウザにて機能がサポートされているか、WebRTCの機能ごとにマップされるハッシュです。<span class='warn'><code>util.supports</code>は、ここで記載されているプロパティのみ保証します。</span></p><div class="children"><div class="child " id="util-supports-audiovideo"><span class="name"><a href="#util-supports-audiovideo">.audioVideo</a><span class="tag type boolean">boolean</span></span><p class="description">利用中のブラウザが、media streamとPeerConnectionをサポートしている場合にtrueとなります。</p></div><div class="child " id="util-supports-data"><span class="name"><a href="#util-supports-data">.data</a><span class="tag type boolean">boolean</span></span><p class="description">利用中のブラウザが、DataChannelとPeerConnectionをサポートしている場合にtrueとなります。</p></div><div class="child " id="util-supports-binary"><span class="name"><a href="#util-supports-binary">.binary</a><span class="tag type boolean">boolean</span></span><p class="description">利用中のブラウザが、binary DataChannelをサポートしている場合にtrueとなります。</p></div><div class="child " id="util-supports-reliable"><span class="name"><a href="#util-supports-reliable">.reliable</a><span class="tag type boolean">boolean</span></span><p class="description">利用中のブラウザが、信頼性のあるDataChannelをサポートしている場合にtrueとなります。</p></div></div></div></div></div>
  </section>

</body>
